#-------------------------------
#
#This input script is used to simulate the defected configuration generated by overlapping cascades initiated at 
#different energies
#Ziqiang Wang on 01/24/2022
#
#-------------------------------

clear
units                    metal
dimension                    3
boundary                 p p p
atom_style               full
atom_modify              map  array

read_data               perfect_relaxed.dat

variable                ratio    equal   0.005

group                   vac_O    id      9177 15948 13753 13704 13785  9875 13138 16565 16815  7095 15345 17202 &
                                         9340 13180 10221  6535 16290 14298  6564 14834 17164  9499 10896  9312 &
                                         11177  8876 12935 17922  8318 14382 14949 11114 10819 17074 14107 14032 &
                                         12547 11223  8983  6867 10419 17329 10568 16510 17952 10865  9795 10743 &
                                         15346  6576 11060 15990 17700 10938 12749 10511 12756 13402 15446 10080 &
                                         17698 16726  8338  8212 15273 12498  9052  8810  7525 12149 14986 13203 &
                                         9056 10840  6492 12627 16843 13681 16414 13886 11490  7540  9119  8829 &
                                         13905  7663  9165 11743 15530 17608 14573  9771 15709 17477 13989 13762 &
                                         17858 13311 10329  6865 10973  7306  7197 14460 14230 13324  9272  8631 &
                                         16803 17847 15410  9329 14399 11570  9755 13487 16631 13657  8300  7991 &
                                         7072  6504 10647 13049  8647 10161  6510 14841  6868 14091 14265  7634 &
                                         10116 15733  9958 12108 16364 10542  7985 11681 14307 14118 12986 15293 &
                                         6508 16937 11804 15510 13661 10528  9431 11919 15250 17806  9726  7520 &
                                         16111 13080 10587 14296 11243 11295 11705 10379  8954  8284 17213 14398 &
                                         9735 10253  7717 16895 13576 13711 16476 10406  7969 16855 16717 14146

group                   oct_O    id     18001 18002 18005 18006 18009 18011 18012 18015 18016 18019 18021 18022 &
                                        18025 18026 18029 18031 18032 18035 18036 18039 18041 18042 18045 18046 &
                                        18051 18052 18055 18056 18059 18061 18062 18065 18066 18069 18071 18072 &
                                        18075 18076 18079 18081 18082 18085 18086 18089 18091 18092 18101 18102 &
                                        18103 18104 18105 18106 18107 18108 18109 18110 18111 18112 18113 18114 &
                                        18115 18116 18117 18118 18119 18120 18121 18122 18123 18151 18152 18155 &
                                        18156 18159 18161 18162 18165 18166 18169 18171 18172 18175 18176 18179 &
                                        18181 18182 18185 18186 18189 18191 18192 18195 18196 18199 18201 18202 &
                                        18205 18206 18209 18211 18212 18215 18216 18219 18221 18222 18225 18226 &
                                        18229 18231 18232 18235 18236 18239 18241 18242 18245 18246 18249 18251 &
                                        18252 18386 18387 18390 18391 18396 18410 18414 18431 18432 18435 18436 &
                                        18439 18445 18449 18482 18486 18489 18491 18492 18495 18496 18501 18502 &
                                        18506 18511 18512 18515 18527 18536 18537 18547 18566 18569 18570 18572 &
                                        18575 18627 18672 18681 18682 18685 18689 18701 18702 18712 18722 18731 &
                                        18732 18736 18741 18743 18777 18786 18807 18882 18926 18928 18931 18932

group                   tot_oct_Th   type   4
group                   tot_oct_O    type   3

group                   delete_oct_O    subtract   tot_oct_O   oct_O


delete_atoms            group  vac_O
delete_atoms            group  tot_oct_Th
delete_atoms            group  delete_oct_O

kspace_style                   pppm            1.0e-5
pair_style                     hybrid/overlay     coul/long    11.0   eam/alloy
pair_coeff                     * * coul/long
pair_coeff                     * * eam/alloy CeThUNpPuAmCmO.eam.alloy O Th O Th
neighbor                 2.0  bin
neigh_modify             delay  0  every  1  check   yes 

set                      type      1      charge    -1.1104
set                      type      2      charge     2.2208
set                      type      3      charge    -1.1104
set                      type      4      charge     2.2208

# Minimize the defected configuration at 0K
min_style                cg
fix                      relax   all  box/relax  aniso 0.0 vmax 0.001
minimize                 1.0e-30 1.0e-30 10000 10000
unfix                    relax
reset_timestep           0

# Apply the temperature to the system and relax the configurations
reset_atom_ids
variable                 temp   index  600
velocity                 all  create  ${temp}  4526826  rot  yes  mom  yes  dist  gaussian
fix                      npt  all  npt  temp  ${temp}  ${temp}  $(100*dt)  aniso  0.0  0.0  $(1000*dt)
timestep                 0.001
thermo                   100000
thermo_style             custom  step  temp  ke  pe  press

shell                    mkdir   Frenkel_${ratio}_relax
dump                     1  all  custom  100000  ./Frenkel_${ratio}_relax/dump_relax.atom.*  id type q mass x y z 
dump_modify              1  element  O Th O Th

run                      100000
shell                    mkdir  thermal_condu
write_data               ./thermal_condu/Frenkel_${ratio}_relaxed.dat

