#-------------------------------
#
#This input script is used to simulate the defected configuration generated by overlapping cascades initiated at 
#different energies
#Ziqiang Wang on 01/24/2022
#
#-------------------------------

clear
units                    metal
dimension                    3
boundary                 p p p
atom_style               full
atom_modify              map  array

read_data               perfect_relaxed.dat

variable                ratio    equal   0.01

group                   vac_Th    id      11    6   31  251   76   96  341  161  156  181  226  431  246  271  &
                                         293  321  521  406  428  456  656  481  501  701  541  561  791  616  &
                                         636  676  881  696  721  743  771  976  856  878  906 1126  931  951  &
                                         973  996 1221 1038 1081 1106 1121 1181 1201 1401 1241 1261 1491 1326  &
                                        1351 1376 1581 1421 1443 1471 1671 1556 1578 1606 1806 1631 1651 1851  &
                                        1691 1711 1951 1766 1786 1826 2051 1846 1871 1891 1926 1946 2191 2021  &
                                        2046 2076 2281 2111 2131 2171 2188 2417 2256 2278 2306 2506 2331 2351  &
                                        2551 2391 2411 2641 2476 2501 2526 2731 2571 2593 2621 2821 2706 2728  &
                                        2756 2956 2781 2801 2841 2861 2916 2936 2976 2996 3013 3033 3253 3054  &
                                        3112 3122 3154 3223 3243 3273 3476 3347 3357 3443 3463 3493 3513 3570  &
                                        3580 3792 3663 3683 3883 3713 3733 3977 3802 3877 3933 3953 4176 4035  &
                                        4045 4312 1139 4143 4193 4213 4270 4280 4492 4373 4393 4413 4433 4672  &
                                        4502 4577 4593 4633 4653 4853 4725 4735 4823 4843 4873 4893


group                   oct_Th    id      18017 21002 18037 18257 21072 21092 18365 18167 21152 18187 21222 18437  &
                                          21242 18277 18295 21317 18524 18412 18430 21452 18659 18487 18507 18707  &
                                          21537 21557 18815 18622 18642 21672 18887 21692 18727 18745 21767 18979  &
                                          18862 18880 21902 19129 18937 18957 18975 21992 19224 19065 19087 22102  &
                                          19124 19187 19207 19407 22237 22257 19515 19332 22347 22372 19587 19427  &
                                          19445 22467 19674 19562 19580 22602 19809 19637 19657 19857 22687 22707  &
                                          19978 19772 19792 22822 20057 22842 19877 19897 22922 22942 20215 20027  &
                                          23042 23072 20287 20117 20137 23167 20190 23438 20262 20280 23302 20509  &
                                          20337 20357 20557 23387 23407 20665 20482 23497 23522 20737 20577 20595  &
                                          23617 20824 20712 20730 23752 20959 20787 20807 23837 23857 20922 20942  &
                                          23972 23992 21019 21039 21259 21060 21139 21149 21160 21229 21249 21279  &
                                          21478 21372 21382 21449 21469 21499 21519 21594 21604 21817 21669 21689  &
                                          21889 21719 21739 21980 21827 21880 21939 21959 22178 22062 22072 22315  &
                                          22135 22149 22199 22219 22294 22304 22517 22379 22399 22419 22439 22675  &
                                          22527 22580 22599 22639 22659 22859 22749 22759 22829 22849 22879 22899  

group                   tot_oct_Th   type   4
group                   tot_oct_O    type   3

group                   delete_oct_Th    subtract   tot_oct_Th   oct_Th


delete_atoms            group  vac_Th
delete_atoms            group  tot_oct_O
delete_atoms            group  delete_oct_Th

kspace_style                   pppm            1.0e-5
pair_style                     hybrid/overlay     coul/long    11.0   eam/alloy
pair_coeff                     * * coul/long
pair_coeff                     * * eam/alloy CeThUNpPuAmCmO.eam.alloy O Th O Th
neighbor                 2.0  bin
neigh_modify             delay  0  every  1  check   yes 

set                      type      1      charge    -1.1104
set                      type      2      charge     2.2208
set                      type      3      charge    -1.1104
set                      type      4      charge     2.2208

# Minimize the defected configuration at 0K
min_style                cg
fix                      relax   all  box/relax  aniso 0.0 vmax 0.001
minimize                 1.0e-30 1.0e-30 10000 10000
unfix                    relax
reset_timestep           0

# Apply the temperature to the system and relax the configurations
reset_atom_ids
variable                 temp   index  600
velocity                 all  create  ${temp}  4526826  rot  yes  mom  yes  dist  gaussian
fix                      npt  all  npt  temp  ${temp}  ${temp}  $(100*dt)  aniso  0.0  0.0  $(1000*dt)
timestep                 0.001
thermo                   100000
thermo_style             custom  step  temp  ke  pe  press

shell                    mkdir   Frenkel_${ratio}_relax
dump                     1  all  custom  100000  ./Frenkel_${ratio}_relax/dump_relax.atom.*  id type q mass x y z 
dump_modify              1  element  O Th O Th

run                      100000
shell                    mkdir  thermal_condu
write_data               ./thermal_condu/Frenkel_${ratio}_relaxed.dat

