#-------------------------------
#
#This input script is used to simulate the defected configuration generated by overlapping cascades initiated at 
#different energies
#Ziqiang Wang on 01/24/2022
#
#-------------------------------

clear
units                    metal
dimension                    3
boundary                 p p p
atom_style               full
atom_modify              map  array

read_data               perfect_relaxed.dat

variable                ratio    equal   0.01

group                   vac_O    id      6002  6033  6062  6186  6206  6224  6272  6312  6352  6455  6482  6513  &
                                         6612  6641  6752  6783  6905  6945  7082  7106  7126  7202  7242  7282  &
                                         6993  7422  7453  7552  7586  7692  7723  7851  7885  7925  7624  8037  &
                                         8052  8057  8072  7752  8325  8365  8482  8497  8502  8517  8652  8765  &
                                         8805  8957  8972  8977  8992  9251  9285  9412  9437  9452  9142  9572  &
                                         9333  9722  9753  9782  9886  9902  9917  9972 10020 10052 10173 10202  &
                                        10233 10337 10352 10367 10472 10503 10622 10653 10682 10816 10836 10922  &
                                        10962 11113 11142 11173 11282 11297 11312 11380 11412 11443 11562 11593  &
                                        11692 11741 11832 11872 12001 12029 12061 12185 12205 12271 12311 12354  &
                                        12453 12481 12509 12611 12640  6749 12779 12909  6939 12949 13081 13105  &
                                        13125 13201 13241 13281 12989 13421 13449 13585 13604 13691 13853  7879  &
                                        13889  7919 13929 13623 14039 14059 13754  8149  8189  8319 14329  8359  &
                                        14369 14484 14504 14523  8589  8629 14654  8759 14769 14801 14829 14959  &
                                        14980  9079  9119 15261 15289 15411 15432 15450  9529 15571 15329 15721  &
                                        15749 15781 15885 15904 15923 15971 16051 16169 16201 16229 16339 16360  

group                   oct_O    id      18065 18079 18095 21161 21181 21386 18215 18235 18435 18304 18320 18334  &
                                         18362 21396 18455 18469 18531 18551 18793 21616 21636 18665 18685 18885  &
                                         18754 18770 18784 18812 21846 18905 18919 18986 19006 19223 22081 19095  &
                                         19109 19115 19315 19135 19241 19261 19320 19334 19340 19354 19585 19461  &
                                         19481 19550 19564 19570 19765 19681 19701 19953 19780 19794 19815 19845  &
                                         19909 19925 19939 20150 23011 20035 20049 20065 23081 20285 20164 20180  &
                                         20375 20250 20264 20278 20315 20510 20390 20404 20600 23476 23496 20525  &
                                         20545 20614 20630 20825 20700 20714 20728 23741 20765 20960 20840 20854  &
                                         20886 23926 20975 20995 21063 21078 21093 21168 21188 21213 21233 21437  &
                                         21303 21318 21333 21362 21403 21444 21468 21533 21539 21553 21792 21623  &
                                         21643 21663 21683 21883 21753 21768 21783 21853 21872 21903 21988 21994  &
                                         22008 22014 22224 22087 22097 22117 22137 22144 22164 22229 22243 22249  &
                                         22263 22322 22342 22542 22364 22384 22587 22449 22463 22478 22674 22552  &
                                         22573 22594 22614 22688 22703 22952 22773 22793 22814 22843 22908 22923  &
                                         22938 23148 23018 23037 23242 23063 23283 23163 23178 23374 23252 23273

group                   tot_oct_Th   type   4
group                   tot_oct_O    type   3

group                   delete_oct_O    subtract   tot_oct_O   oct_O


delete_atoms            group  vac_O
delete_atoms            group  tot_oct_Th
delete_atoms            group  delete_oct_O

kspace_style                   pppm            1.0e-5
pair_style                     hybrid/overlay     coul/long    11.0   eam/alloy
pair_coeff                     * * coul/long
pair_coeff                     * * eam/alloy CeThUNpPuAmCmO.eam.alloy O Th O Th
neighbor                 2.0  bin
neigh_modify             delay  0  every  1  check   yes 

set                      type      1      charge    -1.1104
set                      type      2      charge     2.2208
set                      type      3      charge    -1.1104
set                      type      4      charge     2.2208

# Minimize the defected configuration at 0K
min_style                cg
fix                      relax   all  box/relax  aniso 0.0 vmax 0.001
minimize                 1.0e-30 1.0e-30 10000 10000
unfix                    relax
reset_timestep           0

# Apply the temperature to the system and relax the configurations
reset_atom_ids
variable                 temp   index  600
velocity                 all  create  ${temp}  4526826  rot  yes  mom  yes  dist  gaussian
fix                      npt  all  npt  temp  ${temp}  ${temp}  $(100*dt)  aniso  0.0  0.0  $(1000*dt)
timestep                 0.001
thermo                   100000
thermo_style             custom  step  temp  ke  pe  press

shell                    mkdir   Frenkel_${ratio}_relax
dump                     1  all  custom  100000  ./Frenkel_${ratio}_relax/dump_relax.atom.*  id type q mass x y z 
dump_modify              1  element  O Th O Th

run                      100000
shell                    mkdir  thermal_condu
write_data               ./thermal_condu/Frenkel_${ratio}_relaxed.dat

