#-------------------------------
#
#This input script is used to simulate the defected configuration generated by overlapping cascades initiated at 
#different energies
#Ziqiang Wang on 01/24/2022
#
#-------------------------------

clear
units                    metal
dimension                    3
boundary                 p p p
atom_style               full
atom_modify              map  array

read_data               perfect_relaxed.dat

variable                ratio    equal   0.01

group                   vac_O    id      6004  6035  6044  6075  6227  6242  6247  6262  6464  6495  6504  6535  &
                                         6682  6697  6702  6717  6904  6935  6944  6975  6984  7152  7167  7172  &
                                         7187  7192  7415  7424  7455  7464  7632  7637  7652  7657  7857  7864  &
                                         7895  7904  7935  8078  8082  8097  8102  8117  8304  8335  8344  8375  &
                                         8527  8542  8547  8562  8764  8795  8804  8835  9007  9022  9027  9042  &
                                         9264  9295  9304  9482  9497  9502  9335  9704  9735  9744  9775  9517  &
                                         9927  9942  9947  9962 10164 10195 10204 10235 10382 10397 10402 10417  &
                                         10604 10635 10644 10675 10684 10852 10867 10872 10887 10892 11115 11124 &
                                         11155 11164 11332 11337 11352 11357 11557 11564 11595 11604 11778 11782 &
                                         11797 11802 12008 12048 12086 12121 12260 12278 12468 12508 12581 12621 &
                                         12738 12778  6810 12908 12948 12988 13031 13071 13208 13248 13288 13428 &
                                         13468 13501 13541 13698 13738 13868 13908 13945 13981 14021 14138 14178 &
                                         8210 14308 14348 14386 14421 14560 14578 14768 14808 14891 14931 15068  &
                                         15108 15268 15308 15381 15525 15561 15708 15748 15786 15421 15821 15960 &
                                         9610 15601 16001 16168 16208 16281 16321 16438 16478 10510 16608 16648

group                   oct_O    id      18065 18079 18085 18099 18165 18179 18185 18199 18310 18324 18330 18525  &
                                         18400 18414 18420 18615 18530 18544 18550 18564 18750 18620 18634 18640  &
                                         18654 18840 18764 18770 18784 18788 18854 18860 18874 18878 18989 18995  &
                                         19009 19015 19225 19089 19095 19109 19115 19315 19230 19244 19250 19264  &
                                         19320 19334 19340 19354 19460 19474 19480 19675 19550 19564 19570 19765  &
                                         19690 19704 19710 19780 19794 19800 19909 19915 19929 19935 19949 20009  &
                                         20015 20029 20035 20049 20160 20174 20180 20375 20250 20264 20270 20465  &
                                         20380 20394 20400 20414 20600 20470 20484 20490 20504 20690 20614 20620  &
                                         20634 20638 20704 20710 20724 20728 20834 20840 20854 20860 20924 20930  &
                                         20944 20950 21067 21087 21302 21115 21198 21217 21312 21332 21355 21567  &
                                         21447 21467 21657 21532 21552 21752 21577 21587 21667 21687 21887 21772  &
                                         21789 21800 21810 21907 21924 21997 22017 22032 22042 22267 22147 22167  &
                                         22357 22232 22252 22452 22277 22353 22367 22462 22482 22505 22717 22597  &
                                         22617 22692 22712 22732 22818 22838 22917 22937 23152 22955 22965 23048  &
                                         23054 23058 23078 23162 23182 23205 23417 23297 23317 23507 23382 23402

group                   tot_oct_Th   type   4
group                   tot_oct_O    type   3

group                   delete_oct_O    subtract   tot_oct_O   oct_O


delete_atoms            group  vac_O
delete_atoms            group  tot_oct_Th
delete_atoms            group  delete_oct_O

kspace_style                   pppm            1.0e-5
pair_style                     hybrid/overlay     coul/long    11.0   eam/alloy
pair_coeff                     * * coul/long
pair_coeff                     * * eam/alloy CeThUNpPuAmCmO.eam.alloy O Th O Th
neighbor                 2.0  bin
neigh_modify             delay  0  every  1  check   yes 

set                      type      1      charge    -1.1104
set                      type      2      charge     2.2208
set                      type      3      charge    -1.1104
set                      type      4      charge     2.2208

# Minimize the defected configuration at 0K
min_style                cg
fix                      relax   all  box/relax  aniso 0.0 vmax 0.001
minimize                 1.0e-30 1.0e-30 10000 10000
unfix                    relax
reset_timestep           0

# Apply the temperature to the system and relax the configurations
reset_atom_ids
variable                 temp   index  600
velocity                 all  create  ${temp}  4526826  rot  yes  mom  yes  dist  gaussian
fix                      npt  all  npt  temp  ${temp}  ${temp}  $(100*dt)  aniso  0.0  0.0  $(1000*dt)
timestep                 0.001
thermo                   100000
thermo_style             custom  step  temp  ke  pe  press

shell                    mkdir   Frenkel_${ratio}_relax
dump                     1  all  custom  100000  ./Frenkel_${ratio}_relax/dump_relax.atom.*  id type q mass x y z 
dump_modify              1  element  O Th O Th

run                      100000
shell                    mkdir  thermal_condu
write_data               ./thermal_condu/Frenkel_${ratio}_relaxed.dat

