#-------------------------------
#
#This input script is used to simulate the defected configuration generated by overlapping cascades initiated at 
#different energies
#Ziqiang Wang on 01/24/2022
#
#-------------------------------

clear
units                    metal
dimension                    3
boundary                 p p p
atom_style               full
atom_modify              map  array

read_data               perfect_relaxed.dat

variable                ratio    equal   0.01

group                   vac_O    id      8075 17025  7329 15944  8552  6187 15119 17179 13985  7696  7620 15195  &
                                        12909  9496 11661 10739 11675 12692 14741 15399 13504  8218  6521 15342  &
                                         7293 17737 17622  7183 13159 16052 14823 13069  7538  8262 10201  7951  &
                                        13870 16788  7417 10393 16825 15972  9858 12487  9628 14339  9233 14938  &
                                        15221 10003 13458 17770  9715  7742 17383 13809 12278 12860 15575  9470  &
                                        16937 13385 15674 17136 16111 14152 17826 11842 17568 10939 10559 11155  &
                                        16650 15887 17491 10252 12081  8759  8723 12264 14600 14532 16354 11181  &
                                        10306 10613 13845  8710 14103 14280 16234 11872 17682 12406 15546  8865  &
                                        8655 10908 17123 16975 15076 17975 12200 10776 16480 12177 14517 11386   &
                                        10385 17931 16455 17437 12955 11377 15923 10081  9181 11589 12184 17962  &
                                        11366 13690 11700 10317 15368 17300  9972 10761 17082 15028  9901 14080  &
                                        14962 10979 11905 17275 10136 14474 10718 11944 12040 17723 13274 17940  &
                                        11354 14403 11286 16580 12043 13910 13428 11622 15843 12710 13321 10727  &
                                        12535 17500 14790 16093 16273 11528 13726 14165  9659 14914 17984 14773  &
                                        11769 13076 14236 14282 15627 17020 13629 13991 12668 14692 17534 16537

group                   oct_O    id     18001 18009 18012 18025 18032 18038 18053 18073 18080 18093 18120 18152  &
                                        18160 18168 18172 18188 18192 18203 18223 18243 18251 18259 18262 18275  &
                                        18289 18299 18305 18318 18323 18337 18340 18390 18397 18403 18416 18424  &
                                        18434 18440 18453 18464 18470 18481 18489 18492 18505 18512 18529 18545  &
                                        18548 18553 18611 18624 18626 18644 18673 18684 18690 18711 18722 18728  &
                                        18741 18745 18748 18753 18797 18827 18833 18882 18888 18903 18910 18912  &
                                        18936 18951 18959 18962 18973 18998 19003 19014 19031 19082 19088 19102  &
                                        19105 19118 19122 19133 19182 19188 19201 19210 19212 19228 19239 19258  &
                                        19263 19271 19317 19325 19337 19364 19412 19415 19428 19432 19465 19478  &
                                        19488 19505 19519 19534 19538 19544 19563 19568 19588 19631 19639 19642  &
                                        19655 19662 19669 19678 19683 19698 19705 19767 19775 19786 19805 19833  &
                                        19844 19862 19875 19882 19888 19903 19930 19955 20000 20032 20080 20083  &
                                        20094 20102 20105 20118 20135 20268 20273 20291 20332 20349 20361 20369  &
                                        20435 20477 20498 20523 20528 20552 20565 20572 20595 20608 20613 20628  &
                                        20660 20706 20723 20753 20896 20910 20963 20993 21003 21037 21052 21076


group                   tot_oct   type   3 4 
#group                   tot_oct_O    type   3

group                   delete_oct_O    subtract   tot_oct  oct_O

delete_atoms            group  vac_O
delete_atoms            group  delete_oct_O

kspace_style                   pppm            1.0e-5
pair_style                     hybrid/overlay     coul/long    11.0   eam/alloy
pair_coeff                     * * coul/long
pair_coeff                     * * eam/alloy CeThUNpPuAmCmO.eam.alloy O Th O O
neighbor                 2.0  bin
neigh_modify             delay  0  every  1  check   yes 

set                      type      1      charge    -1.1104
set                      type      2      charge     2.2208
set                      type      3      charge    -1.1104
set                      type      4      charge    -1.1104

# Minimize the defected configuration at 0K
min_style                cg
fix                      relax   all  box/relax  aniso 0.0 vmax 0.001
minimize                 1.0e-30 1.0e-30 10000 10000
unfix                    relax
reset_timestep           0

# Apply the temperature to the system and relax the configurations
reset_atom_ids
variable                 temp   index  600
velocity                 all  create  ${temp}  4526826  rot  yes  mom  yes  dist  gaussian
fix                      npt  all  npt  temp  ${temp}  ${temp}  $(100*dt)  aniso  0.0  0.0  $(1000*dt)
timestep                 0.001
thermo                   100000
thermo_style             custom  step  temp  ke  pe  press

shell                    mkdir   Frenkel_${ratio}_relax
dump                     1  all  custom  100000  ./Frenkel_${ratio}_relax/dump_relax.atom.*  id type q mass x y z 
dump_modify              1  element  O Th O Th

run                      100000
shell                    mkdir  thermal_condu
write_data               ./thermal_condu/Frenkel_${ratio}_relaxed.dat

