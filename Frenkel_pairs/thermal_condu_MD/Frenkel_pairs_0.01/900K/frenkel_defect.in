#-------------------------------
#
#This input script is used to simulate the defected configuration generated by overlapping cascades initiated at 
#different energies
#Ziqiang Wang on 01/24/2022
#
#-------------------------------

clear
units                    metal
dimension                    3
boundary                 p p p
atom_style               full
atom_modify              map  array

read_data               perfect_relaxed.dat

variable                ratio    equal   0.005
group                   vac_Th   id      5151 5614 4087  268 5189   90 1602 3980 2857  918 3965 3473 3655 1715  &
                                         5673 4384 4835 5991 3898 1926 1435 3666 5514 5932 2590 5254 2085  512  &
                                         1023 5342 2287  989 3278 5325 5491 2935 5384 5432 2341 5780 5929 1957  &
                                         414 1270 2968 2394 4909  679  632 1205 5943 2661 2982 1267 3331 4533   &
                                         4152 5638 2547 5723


group                   vac_O    id     9066  7216 15374 13959 15885 12791  6734  9485 11649 10001  7669  9513 &
                                        6600 14206 16258 13798 13628  7697 14875  6812  7027 10802 10053  7384 &
                                        11294 16970 16720 15880  8558 11983 14345 11434 14613 12306  8552 10491 &
                                        10165 13902 17019  7976 16089 10729 17142 11856  7675  6681 15690 17207 &
                                        8156  9518 12445 13508 16547  8466 16824 15892 11755 13179  7492 11369  &
                                        16749 12149 14739 15818 17847  6726 10414 11920 16364 11710 11221  8560 &
                                        13271 10156 13024 15468 11064  8774 12612 16494 11108  7474  7370 15228 &
                                        11451 12437 10878 16775 14249  9827 17495 16575 17139  7593 13586  7538 &
                                        10731 11368  9226  7977  8441 11562 10578  9067  7990 16598 14412  9673 &
                                        13260  6570 12618 17187  9385  7456 15928 10743  6833  8474 12434 15408

group                   oct_Th   id     18003 18004 18007 18008 18010 18013 18014 18017 18018 18020 18023 18024 &
                                        18027 18030 18033 18034 18043 18044 18053 18054 18057 18058 18060 18063 &
                                        18064 18067 18068 18070 18073 18074 18077 18083 18126 18127 18128 18129 &
                                        18130 18131 18132 18133 18134 18135 18136 18137 18138 18140 18141 18153 &
                                        18154 18157 18158 18160 18163 18164 18167 18168 18170 18173 18174 18177

group                   oct_O    id     18001 18002 18005 18006 18009 18011 18012 18015 18016 18019 18021 18022  &
                                        18025 18026 18029 18031 18032 18036 18041 18042 18046 18049 18051 18052  &
                                        18055 18056 18059 18061 18062 18065 18066 18069 18071 18072 18082 18092  &
                                        18101 18102 18103 18104 18105 18106 18107 18108 18109 18110 18111 18112  &
                                        18117 18151 18152 18155 18156 18159 18161 18162 18165 18166 18169 18171  &
                                        18172 18175 18176 18179 18181 18201 18202 18205 18206 18209 18211 18212  &
                                        18215 18216 18219 18221 18222 18225 18226 18229 18235 18282 18286 18291  &
                                        18293 18327 18336 18352 18357 18407 18416 18417 18452 18461 18462 18476  &
                                        18478 18480 18481 18485 18486 18489 18492 18495 18496 18499 18505 18509  &
                                        18550 18554 18582 18583 18637 18712 18722 18926 18932 18976 19026 19112


group                   tot_oct_Th   type   4
group                   tot_oct_O    type   3

group                   delete_oct_Th   subtract   tot_oct_Th  oct_Th
group                   delete_oct_O    subtract   tot_oct_O   oct_O

delete_atoms            group  vac_Th
delete_atoms            group  vac_O
delete_atoms            group  delete_oct_Th
delete_atoms            group  delete_oct_O

kspace_style                   pppm            1.0e-5
pair_style                     hybrid/overlay     coul/long    11.0   eam/alloy
pair_coeff                     * * coul/long
pair_coeff                     * * eam/alloy CeThUNpPuAmCmO.eam.alloy O Th O Th
neighbor                 2.0  bin
neigh_modify             delay  0  every  1  check   yes 

set                      type      1      charge    -1.1104
set                      type      2      charge     2.2208
set                      type      3      charge    -1.1104
set                      type      4      charge     2.2208

# Minimize the defected configuration at 0K
min_style                cg
fix                      relax   all  box/relax  aniso 0.0 vmax 0.001
minimize                 1.0e-30 1.0e-30 10000 10000
unfix                    relax
reset_timestep           0

# Apply the temperature to the system and relax the configurations
reset_atom_ids
variable                 temp   index  900
velocity                 all  create  ${temp}  4526826  rot  yes  mom  yes  dist  gaussian
fix                      npt  all  npt  temp  ${temp}  ${temp}  $(100*dt)  aniso  0.0  0.0  $(1000*dt)
timestep                 0.001
thermo                   100000
thermo_style             custom  step  temp  ke  pe  press

shell                    mkdir   Frenkel_${ratio}_relax
dump                     1  all  custom  100000  ./Frenkel_${ratio}_relax/dump_relax.atom.*  id type q mass x y z 
dump_modify              1  element  O Th O Th

run                      100000
shell                    mkdir  thermal_condu
write_data               ./thermal_condu/Frenkel_${ratio}_relaxed.dat

