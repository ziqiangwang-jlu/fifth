#-------------------------------
#
#This input script is used to simulate the defected configuration generated by overlapping cascades initiated at 
#different energies
#Ziqiang Wang on 01/24/2022
#
#-------------------------------

clear
units                    metal
dimension                    3
boundary                 p p p
atom_style               full
atom_modify              map  array

read_data               perfect_relaxed.dat

variable                ratio    equal   0.01
group                   vac_Th   id      246 3108 4290 3302 4357  573 1267 1241 1452  590  584 5826 2722 3197 &
                                         622 1344 5217  751 5586 5369 4284 3907 3044 1127 1012 2991 3205 1666 &
                                         2985 2132 2432 4577 1889 2997 4439 2898  848 3992 5550 1239 2660 3361 &
                                         3177 3275 2572 3551 5474 2868 1841 3345 1449 4687 4612 5902 3763 4554 &
                                         2602 5094 3683 5990

group                   vac_O    id      12279 10217 14224 11031  9288  7271 17670  9595 11387 17784 10130 15268 &
                                         13163  6383 13657  8718 12097 15921 15664 10364 17029 16134 11557  9000 &
                                         7317 15057 15691 14022 14625 16268 11372 13752 12739 14650 11002 16544 &
                                         8724  6826 14871 11049 13412 11871 11814 15417  7403 14433 17429 14422 &
                                         10542  7000 12001 14540 16519  8683 17193 10500 10239 12674 15944 10775 &
                                         14297 10055 15050  9910  8806 17132 15165 10429 13636  7744 11545  8108 &
                                         14634 10926 12516 10464 15807  7799 17723  7280  6395 13794 11758  8701 &
                                         9530 15175 11501 15718 12804 17714 10712 17814 13848 14751 16259 10179 &
                                         17154  9696 13094  9997 16329 15184 13429 10684 14742 13655 10099 11451 &
                                         8790 13138 15793  9463 14543 17910 14407 16210 15533 14208 15545 12206

group                   oct_Th   id      18003 18018 18034 18054 18074 18080 18093 18126 18135 18145 18160 18224 &
                                         18238 18244 18260 18294 18309 18329 18340 18368 18378 18403 18427 18460 &
                                         18463 18468 18543 18563 18591 18604 18649 18668 18684 18690 18698 18727 &
                                         18745 18763 18783 18826 18862 18883 18894 18908 18924 18950 18990 19004 &
                                         19059 19083 19097 19122 19125 19134 19168 19213 19218 19249 19296 19303 

group                   oct_O    id      18005 18011 18022 18029 18042 18045 18059 18062 18085 18096 18103 18109 &
                                         18119 18125 18156 18162 18175 18181 18192 18195 18201 18215 18229 18232 &
                                         18256 18262 18269 18276 18282 18289 18297 18310 18317 18324 18341 18350 &
                                         18354 18391 18406 18414 18421 18439 18442 18456 18481 18489 18492 18505 &
                                         18511 18521 18530 18536 18547 18554 18567 18573 18579 18626 18634 18637 &
                                         18654 18661 18672 18705 18711 18719 18722 18735 18741 18757 18774 18776 &
                                         18792 18795 18801 18807 18850 18857 18876 18889 18911 18932 18935 18946 &
                                         18952 18959 18966 18976 18986 18992 19005 19019 19027 19030 19036 19045 &
                                         19085 19099 19102 19116 19139 19142 19155 19161 19176 19180 19186 19192 &
                                         19199 19206 19223 19227 19234 19254 19269 19276 19285 19286 19320 19337 

group                   tot_oct_Th   type   4
group                   tot_oct_O    type   3

group                   delete_oct_Th   subtract   tot_oct_Th  oct_Th
group                   delete_oct_O    subtract   tot_oct_O   oct_O

delete_atoms            group  vac_Th
delete_atoms            group  vac_O
delete_atoms            group  delete_oct_Th
delete_atoms            group  delete_oct_O

kspace_style                   pppm            1.0e-5
pair_style                     hybrid/overlay     coul/long    11.0   eam/alloy
pair_coeff                     * * coul/long
pair_coeff                     * * eam/alloy CeThUNpPuAmCmO.eam.alloy O Th O Th
neighbor                 2.0  bin
neigh_modify             delay  0  every  1  check   yes 

set                      type      1      charge    -1.1104
set                      type      2      charge     2.2208
set                      type      3      charge    -1.1104
set                      type      4      charge     2.2208

# Minimize the defected configuration at 0K
min_style                cg
fix                      relax   all  box/relax  aniso 0.0 vmax 0.001
minimize                 1.0e-30 1.0e-30 10000 10000
unfix                    relax
reset_timestep           0

# Apply the temperature to the system and relax the configurations
reset_atom_ids
variable                 latt  equal  (lx/5+ly/60+lz/5)/3
variable                 temp  index  1200
velocity                 all  create  ${temp}  1001  rot  yes  mom  yes  dist  gaussian
fix                      npt  all  npt  temp  ${temp}  ${temp}  $(100*dt)  aniso  0.0  0.0  $(1000*dt)
timestep                 0.001
thermo                   50000
thermo_style             custom  step  temp dt time atoms etotal ke  pe  press  v_latt

shell                    mkdir   Frenkel_${ratio}_relax
dump                     1  all  custom  50000  ./Frenkel_${ratio}_relax/dump_relax.atom.*  id type q mass x y z 
dump_modify              1  element  O Th O Th

run                      100000
shell                    mkdir  thermal_condu
write_data               ./thermal_condu/Frenkel_${ratio}_relaxed.dat

