#-------------------------------
#
#This input script is used to simulate the defected configuration generated by overlapping cascades initiated at 
#different energies
#Ziqiang Wang on 01/24/2022
#
#-------------------------------

clear
units                    metal
dimension                    3
boundary                 p p p
atom_style               full
atom_modify              map  array

read_data               perfect_relaxed.dat

variable                ratio    equal   0.01

group                   vac_Th    id      5089 2735  408 1345 3148  128 5249 1052 1891 5555 1584 1784 3638 3187  &
                                          3093 1489 1296 5040 1163 1758 4286 5571 3815 4403 5120 5540 2825  537  &
                                          1867 3254 4896  234 1570 4114 4522 2420  292 3114 4598  546 5013 4792  &
                                          634 2467 1023 1316 1627 2901 5850 3410  294 2533 3155  561 3130 1277  &
                                          4853 5262 4809  277 1813 4056  527 4770 4405  583 3880 2932  468 5893  &
                                          2105  542 2982  485 3994 4876 1721 4931 2626 3500  476  672 1978 5623  &
                                          4428 2763 5400 2015 5276 4922 2337 1945 4170 5202 5597 4839 2306 4115  &
                                          4353 5424 5569 2937 4525 1164 4993 5107 3088 3188 5697 4847 5675 3602  &
                                          2567 3872  806 2673 5511 3278 5668 1799 4336  742 5358 5822 3324 5215  &
                                          2067 3160 5831 2941 2789 1396 5019 4776 5126 2035 1854 5087 1225 1697  &
                                          4421 4830 2102 2807 4133 1704 5726 1385 5567 2671 4757 5265 1954 5377  &
                                          5608 5719 4756  454 5508 3493 5681 3674 3587 4062 1946 5769 5842 4995  &
                                          5827 3238 5744 5128 4207 2028 4715 5046 5440 5879 2160 2418

group                   oct_Th    id      18003 18004 18007 18008 18010 18013 18014 18017 18018 18020 18023 18024  &
                                          18027 18028 18030 18033 18034 18037 18043 18044 18047 18053 18063 18064  &
                                          18068 18073 18074 18077 18078 18080 18083 18084 18087 18093 18094 18097  &
                                          18131 18132 18136 18137 18138 18139 18140 18141 18142 18143 18144 18145  &
                                          18146 18147 18148 18153 18163 18164 18168 18173 18177 18178 18180 18188  &
                                          18190 18198 18203 18204 18207 18208 18210 18213 18214 18217 18218 18220  &
                                          18227 18228 18230 18240 18248 18250 18253 18254 18257 18263 18298 18299  &
                                          18302 18303 18308 18318 18363 18364 18365 18366 18372 18377 18379 18381  &
                                          18382 18383 18384 18385 18388 18392 18393 18405 18434 18437 18438 18440  &
                                          18450 18460 18589 18653 18670 18694 18698 18700 18713 18714 18718 18723  &
                                          18727 18728 18730 18740 18758 18763 18775 18785 18818 18820 18821 18827  &
                                          18832 18838 18839 18842 18843 18848 18849 18852 18853 18858 18862 18863  &
                                          18865 18872 18875 18883 18884 18887 18888 18890 18893 18894 18897 18898  &
                                          18900 18903 18904 18907 18908 18910 18913 18914 18917 18918 18920 18922  &
                                          18924 18938 18940 18943 18944 18947 18948 18953 18957 18993 18994 18997

group                   tot_oct_Th   type   4
group                   tot_oct_O    type   3

group                   delete_oct_Th    subtract   tot_oct_Th   oct_Th


delete_atoms            group  vac_Th
delete_atoms            group  tot_oct_O
delete_atoms            group  delete_oct_Th

kspace_style                   pppm            1.0e-5
pair_style                     hybrid/overlay     coul/long    11.0   eam/alloy
pair_coeff                     * * coul/long
pair_coeff                     * * eam/alloy CeThUNpPuAmCmO.eam.alloy O Th O Th
neighbor                 2.0  bin
neigh_modify             delay  0  every  1  check   yes 

set                      type      1      charge    -1.1104
set                      type      2      charge     2.2208
set                      type      3      charge    -1.1104
set                      type      4      charge     2.2208

# Minimize the defected configuration at 0K
min_style                cg
fix                      relax   all  box/relax  aniso 0.0 vmax 0.001
minimize                 1.0e-30 1.0e-30 10000 10000
unfix                    relax
reset_timestep           0

# Apply the temperature to the system and relax the configurations
reset_atom_ids
variable                 temp   index  600
velocity                 all  create  ${temp}  4526826  rot  yes  mom  yes  dist  gaussian
fix                      npt  all  npt  temp  ${temp}  ${temp}  $(100*dt)  aniso  0.0  0.0  $(1000*dt)
timestep                 0.001
thermo                   100000
thermo_style             custom  step  temp  ke  pe  press

shell                    mkdir   Frenkel_${ratio}_relax
dump                     1  all  custom  100000  ./Frenkel_${ratio}_relax/dump_relax.atom.*  id type q mass x y z 
dump_modify              1  element  O Th O Th

run                      100000
shell                    mkdir  thermal_condu
write_data               ./thermal_condu/Frenkel_${ratio}_relaxed.dat

